# æ¶æ§‹é‡æ§‹é·ç§»æŒ‡å—

## ğŸ¯ é‡æ§‹ç›®æ¨™

è§£æ±ºã€Œä¿® A å£ Bã€çš„å•é¡Œï¼Œå»ºç«‹çµ±ä¸€çš„è³‡æ–™å±¤æ¶æ§‹ï¼Œæ¶ˆé™¤è·¨é é¢è€¦åˆã€‚

## ğŸ—ï¸ æ–°æ¶æ§‹ç‰¹é»

### 1. çµ±ä¸€çš„è³‡æ–™ç®¡ç†å±¤ (`dataManager`)
- **å–®ä¸€è³‡æ–™ä¾†æº**ï¼šæ‰€æœ‰è³‡æ–™é€šé `dataManager` ç®¡ç†
- **è‡ªå‹•å¿«å–**ï¼š5åˆ†é˜å¿«å–ç­–ç•¥ï¼Œé¿å…é‡è¤‡è«‹æ±‚
- **è¨‚é–±æ¨¡å¼**ï¼šè³‡æ–™è®Šæ›´æ™‚è‡ªå‹•é€šçŸ¥æ‰€æœ‰è¨‚é–±è€…
- **ä¸€è‡´æ€§ä¿è­‰**ï¼šæ‰€æœ‰é é¢çœ‹åˆ°çš„è³‡æ–™éƒ½æ˜¯åŒæ­¥çš„

### 2. çµ±ä¸€çš„ React Hooks (`useDataManager`)
- **ä¸€è‡´çš„ä»‹é¢**ï¼šæ‰€æœ‰é é¢ä½¿ç”¨ç›¸åŒçš„ Hook ä»‹é¢
- **è‡ªå‹•è¨‚é–±**ï¼šHook è‡ªå‹•è¨‚é–±è³‡æ–™è®Šæ›´
- **éŒ¯èª¤è™•ç†**ï¼šçµ±ä¸€çš„éŒ¯èª¤è™•ç†æ©Ÿåˆ¶
- **è¼‰å…¥ç‹€æ…‹**ï¼šçµ±ä¸€çš„è¼‰å…¥ç‹€æ…‹ç®¡ç†

### 3. çµ±ä¸€çš„é é¢å®¹å™¨ (`BasePageContainer`)
- **éŒ¯èª¤é‚Šç•Œ**ï¼šè‡ªå‹•æ•ç²å’Œè™•ç†éŒ¯èª¤
- **èªè­‰æª¢æŸ¥**ï¼šçµ±ä¸€çš„èªè­‰é‚è¼¯
- **å¿«å–ç®¡ç†**ï¼šçµ±ä¸€çš„å¿«å–æ¸…é™¤ç­–ç•¥
- **é€šçŸ¥ç³»çµ±**ï¼šçµ±ä¸€çš„æˆåŠŸ/éŒ¯èª¤é€šçŸ¥

## ğŸ“‹ é·ç§»æ­¥é©Ÿ

### æ­¥é©Ÿ 1ï¼šæ›¿æ›ç¾æœ‰é é¢å®¹å™¨

```bash
# å‚™ä»½ç¾æœ‰æª”æ¡ˆ
cp src/pages/FavoritesPageContainer.tsx src/pages/FavoritesPageContainer.old.tsx
cp src/pages/MyVisitsPageContainer.tsx src/pages/MyVisitsPageContainer.old.tsx
cp src/pages/HomePage.tsx src/pages/HomePage.old.tsx

# ä½¿ç”¨æ–°çš„å®¹å™¨
cp src/pages/FavoritesPageContainer.new.tsx src/pages/FavoritesPageContainer.tsx
cp src/pages/MyVisitsPageContainer.new.tsx src/pages/MyVisitsPageContainer.tsx
cp src/pages/HomePageContainer.new.tsx src/pages/HomePage.tsx
```

### æ­¥é©Ÿ 2ï¼šæ›´æ–°è·¯ç”±é…ç½®

```bash
# å‚™ä»½ç¾æœ‰è·¯ç”±
cp src/routes/AppRoutes.tsx src/routes/AppRoutes.old.tsx

# ä½¿ç”¨æ–°çš„è·¯ç”±
cp src/routes/AppRoutes.new.tsx src/routes/AppRoutes.tsx
```

### æ­¥é©Ÿ 3ï¼šæ›´æ–° App.tsx

```typescript
// src/App.tsx
import React from 'react'
import { BrowserRouter } from 'react-router-dom'
import { ThemeProvider } from '@mui/material/styles'
import { CssBaseline } from '@mui/material'
import AppRoutes from './routes/AppRoutes'
import theme from './theme'

function App() {
  return (
    <BrowserRouter>
      <ThemeProvider theme={theme}>
        <CssBaseline />
        <AppRoutes />
      </ThemeProvider>
    </BrowserRouter>
  )
}

export default App
```

### æ­¥é©Ÿ 4ï¼šç§»é™¤èˆŠçš„ Hooksï¼ˆå¯é¸ï¼‰

```bash
# å‚™ä»½èˆŠçš„ hooks
cp src/hooks/useStores.ts src/hooks/useStores.old.ts
cp src/hooks/useFavorites.ts src/hooks/useFavorites.old.ts

# é€™äº›æª”æ¡ˆå¯ä»¥ä¿ç•™ä½œç‚ºå‚™ä»½ï¼Œæˆ–è€…åˆªé™¤
```

## ğŸ”„ è³‡æ–™æµç¨‹å°æ¯”

### èˆŠæ¶æ§‹ï¼ˆæœ‰å•é¡Œï¼‰
```
Page A â†’ useStores â†’ API â†’ æ›´æ–°æœ¬åœ°ç‹€æ…‹
Page B â†’ useFavorites â†’ API â†’ æ›´æ–°æœ¬åœ°ç‹€æ…‹
Page C â†’ useVisits â†’ API â†’ æ›´æ–°æœ¬åœ°ç‹€æ…‹

å•é¡Œï¼šå„é é¢ç¨ç«‹ç®¡ç†ç‹€æ…‹ï¼Œå®¹æ˜“ä¸åŒæ­¥
```

### æ–°æ¶æ§‹ï¼ˆè§£æ±ºå•é¡Œï¼‰
```
æ‰€æœ‰é é¢ â†’ useDataManager â†’ dataManager â†’ API
                â†“
        çµ±ä¸€çš„å¿«å–å’Œè¨‚é–±ç³»çµ±
                â†“
        æ‰€æœ‰é é¢è‡ªå‹•åŒæ­¥æ›´æ–°
```

## ğŸ‰ é‡æ§‹å¾Œçš„å¥½è™•

### 1. æ¶ˆé™¤è€¦åˆ
- **è³‡æ–™ä¸€è‡´æ€§**ï¼šæ‰€æœ‰é é¢çœ‹åˆ°çš„è³‡æ–™éƒ½æ˜¯åŒæ­¥çš„
- **ç‹€æ…‹éš”é›¢**ï¼šæ¯å€‹é é¢åªé—œå¿ƒè‡ªå·±çš„ UI é‚è¼¯
- **éŒ¯èª¤éš”é›¢**ï¼šä¸€å€‹é é¢çš„éŒ¯èª¤ä¸æœƒå½±éŸ¿å…¶ä»–é é¢

### 2. æå‡ç¶­è­·æ€§
- **å–®ä¸€è·è²¬**ï¼šæ¯å€‹çµ„ä»¶åªè² è²¬è‡ªå·±çš„åŠŸèƒ½
- **çµ±ä¸€ä»‹é¢**ï¼šæ‰€æœ‰é é¢ä½¿ç”¨ç›¸åŒçš„è³‡æ–™å­˜å–æ–¹å¼
- **æ˜“æ–¼æ¸¬è©¦**ï¼šå¯ä»¥ç¨ç«‹æ¸¬è©¦æ¯å€‹çµ„ä»¶

### 3. æå‡æ€§èƒ½
- **æ™ºèƒ½å¿«å–**ï¼šé¿å…é‡è¤‡çš„ API è«‹æ±‚
- **æŒ‰éœ€æ›´æ–°**ï¼šåªæœ‰ç›¸é—œé é¢æœƒé‡æ–°æ¸²æŸ“
- **æ‰¹é‡æ“ä½œ**ï¼šå¤šå€‹æ“ä½œå¯ä»¥æ‰¹é‡è™•ç†

## ğŸš¨ æ³¨æ„äº‹é …

### 1. å‘å¾Œç›¸å®¹æ€§
- ç¾æœ‰çš„ API ä»‹é¢ä¿æŒä¸è®Š
- ç¾æœ‰çš„çµ„ä»¶ä»‹é¢ä¿æŒä¸è®Š
- åªæ˜¯å…§éƒ¨å¯¦ç¾æ”¹è®Š

### 2. æ¸¬è©¦å»ºè­°
- æ¸¬è©¦æ¯å€‹é é¢çš„åŸºæœ¬åŠŸèƒ½
- æ¸¬è©¦è·¨é é¢çš„è³‡æ–™åŒæ­¥
- æ¸¬è©¦éŒ¯èª¤è™•ç†æ©Ÿåˆ¶

### 3. ç›£æ§å»ºè­°
- ç›£æ§ API è«‹æ±‚æ¬¡æ•¸ï¼ˆæ‡‰è©²æ¸›å°‘ï¼‰
- ç›£æ§é é¢è¼‰å…¥æ™‚é–“ï¼ˆæ‡‰è©²æå‡ï¼‰
- ç›£æ§éŒ¯èª¤ç™¼ç”Ÿç‡ï¼ˆæ‡‰è©²é™ä½ï¼‰

## ğŸ”§ æ•…éšœæ’é™¤

### å•é¡Œ 1ï¼šè³‡æ–™ä¸åŒæ­¥
**åŸå› **ï¼šå¯èƒ½æ²’æœ‰æ­£ç¢ºä½¿ç”¨æ–°çš„ Hook
**è§£æ±º**ï¼šç¢ºä¿ä½¿ç”¨ `useDataManager` ä¸­çš„ Hook

### å•é¡Œ 2ï¼šå¿«å–å•é¡Œ
**åŸå› **ï¼šå¿«å–å¯èƒ½éæœŸæˆ–æå£
**è§£æ±º**ï¼šèª¿ç”¨ `clearCache()` æ¸…é™¤å¿«å–

### å•é¡Œ 3ï¼šè¨‚é–±å•é¡Œ
**åŸå› **ï¼šå¯èƒ½æ²’æœ‰æ­£ç¢ºè¨‚é–±è³‡æ–™è®Šæ›´
**è§£æ±º**ï¼šæª¢æŸ¥ Hook çš„ `useEffect` ä¾è³´

## ğŸ“ˆ æ€§èƒ½ç›£æ§

### é—œéµæŒ‡æ¨™
- **API è«‹æ±‚æ¬¡æ•¸**ï¼šæ‡‰è©²æ¸›å°‘ 50% ä»¥ä¸Š
- **é é¢è¼‰å…¥æ™‚é–“**ï¼šæ‡‰è©²æå‡ 30% ä»¥ä¸Š
- **è¨˜æ†¶é«”ä½¿ç”¨**ï¼šæ‡‰è©²æ›´ç©©å®š
- **éŒ¯èª¤ç‡**ï¼šæ‡‰è©²é™ä½ 80% ä»¥ä¸Š

### ç›£æ§å·¥å…·
```typescript
// åœ¨é–‹ç™¼ç’°å¢ƒä¸­å•Ÿç”¨æ€§èƒ½ç›£æ§
if (process.env.NODE_ENV === 'development') {
  const { clearCache } = useCacheStatus()
  
  // ç›£æ§å¿«å–ç‹€æ…‹
  console.log('Cache status:', dataManager.getCacheStatus())
  
  // ç›£æ§ API è«‹æ±‚
  console.log('API requests:', dataManager.getRequestCount())
}
```

## ğŸ¯ ä¸‹ä¸€æ­¥è¨ˆåŠƒ

1. **å®Œæˆé·ç§»**ï¼šæŒ‰ç…§æ­¥é©Ÿå®Œæˆæ‰€æœ‰é é¢çš„é·ç§»
2. **æ€§èƒ½æ¸¬è©¦**ï¼šæ¸¬è©¦æ–°æ¶æ§‹çš„æ€§èƒ½è¡¨ç¾
3. **ç”¨æˆ¶æ¸¬è©¦**ï¼šç¢ºä¿ç”¨æˆ¶é«”é©—æ²’æœ‰ä¸‹é™
4. **æ–‡æª”æ›´æ–°**ï¼šæ›´æ–°é–‹ç™¼æ–‡æª”å’Œ API æ–‡æª”
5. **åœ˜éšŠåŸ¹è¨“**ï¼šåŸ¹è¨“åœ˜éšŠä½¿ç”¨æ–°çš„æ¶æ§‹
